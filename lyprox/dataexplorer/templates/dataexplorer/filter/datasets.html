{% load sekizai_tags %}
{% load static %}
{% load customtags %}

{% addtoblock "css" %}
<link rel="stylesheet" href="{% static 'dataexplorer/datasets.css' %}?v={{ VERSION }}">
{% endaddtoblock %}

<div class="box is-height-100">
  <div class="level">
    <div class="level-left">
      <div class="level-item">
        <p class="title is-4">Datasets</p>
      </div>
    </div>
    <div class="level-right">
      <div class="level-item">
        <div class="tooltip">
          <span class="icon">
            <i class="fas fa-question"></i>
          </span>
          {% include 'dataexplorer/help/tooltip.html' with side="left" position="bottom" image='dataexplorer/help/institutions.gif' markdown='dataexplorer/help/institutions.md' %}
        </div>
      </div>
    </div>
  </div>

  <div class="field is-grouped is-grouped-multiline">
    {% for checkbox in form.datasets %}
    <div class="control">
      {{ checkbox.tag }}
      <div class="dataset buttons has-addons">
        <label for="{{ checkbox.id_for_label }}" class="button is-medium is-size-6 is-link is-light">
          <span class="icon is-large tag has-background-white p-1 mx-1">
            <img src="{{ checkbox.choice_label|get_logo }}" alt="institution logo">
          </span>
          <span>{{ checkbox.choice_label|get_subsite }}</span>
        </label>
        <div class="button is-medium is-size-6 is-static">
          <span class="stats dataset-count" data-statfield="datasets" data-key="{{ checkbox.choice_label }}">
            {% if show_percent %}
              {{ stats.datasets|get_percent:checkbox.choice_label }}%
            {% else %}
              {{ stats.datasets|get:checkbox.choice_label|default:0 }}
            {% endif %}
          </span>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
